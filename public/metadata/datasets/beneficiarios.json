{
    "id": "beneficiarios",
    "name": "Beneficiarios",
    "sources": [
        "beneficiarios/ben_202201.parquet",
        "beneficiarios/ben_202202.parquet"
    ],
    "schema": [
        {
            "name": "COMPETENCIA",
            "type": "INTEGER"
        },
        {
            "name": "CD_OPERADORA",
            "type": "VARCHAR"
        },
        {
            "name": "NM_RAZAO_SOCIAL",
            "type": "VARCHAR"
        },
        {
            "name": "MODALIDADE_OPERADORA",
            "type": "VARCHAR"
        },
        {
            "name": "SG_UF",
            "type": "VARCHAR"
        },
        {
            "name": "CD_MUNICIPIO",
            "type": "VARCHAR"
        },
        {
            "name": "NM_MUNICIPIO",
            "type": "VARCHAR"
        },
        {
            "name": "TP_SEXO",
            "type": "VARCHAR"
        },
        {
            "name": "DE_FAIXA_ETARIA",
            "type": "VARCHAR"
        },
        {
            "name": "DE_FAIXA_ETARIA_REAJ",
            "type": "VARCHAR"
        },
        {
            "name": "TP_VIGENCIA_PLANO",
            "type": "VARCHAR"
        },
        {
            "name": "DE_CONTRATACAO_PLANO",
            "type": "VARCHAR"
        },
        {
            "name": "DE_SEGMENTACAO_PLANO",
            "type": "VARCHAR"
        },
        {
            "name": "DE_ABRG_GEOGRAFICA_PLANO",
            "type": "VARCHAR"
        },
        {
            "name": "COBERTURA_ASSIST_PLAN",
            "type": "VARCHAR"
        },
        {
            "name": "TIPO_VINCULO",
            "type": "VARCHAR"
        },
        {
            "name": "QT_ATIVOS",
            "type": "INTEGER"
        },
        {
            "name": "QT_ADESOES",
            "type": "INTEGER"
        },
        {
            "name": "QT_CANCELAMENTOS",
            "type": "INTEGER"
        }
    ],
    "semantic": {
        "dimensions": [
            {
                "name": "COMPETENCIA",
                "label": "Competência",
                "dataType": "VARCHAR",
                "sql": "COMPETENCIA"
            },
            {
                "name": "CD_OPERADORA",
                "label": "Código Operadora",
                "dataType": "VARCHAR",
                "sql": "CD_OPERADORA"
            },
            {
                "name": "NM_RAZAO_SOCIAL",
                "label": "Razão Social",
                "dataType": "VARCHAR",
                "sql": "NM_RAZAO_SOCIAL"
            },
            {
                "name": "MODALIDADE_OPERADORA",
                "label": "Modalidade Operadora",
                "dataType": "VARCHAR",
                "sql": "MODALIDADE_OPERADORA"
            },
            {
                "name": "residencia",
                "label": "Residência",
                "type": "geo",
                "subDimensions": [
                    {
                        "name": "estado",
                        "label": "Estado",
                        "attributes": [
                            {
                                "name": "uf",
                                "label": "UF",
                                "sql": "SG_UF",
                                "type": "VARCHAR"
                            }
                        ],
                        "subDimensions": [
                            {
                                "name": "municipio",
                                "label": "Município",
                                "attributes": [
                                    {
                                        "name": "cd_municipio",
                                        "label": "Código Município",
                                        "sql": "CD_MUNICIPIO",
                                        "type": "VARCHAR"
                                    },
                                    {
                                        "name": "municipio",
                                        "label": "Município",
                                        "sql": "NM_MUNICIPIO",
                                        "type": "VARCHAR"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "name": "TP_SEXO",
                "label": "Sexo",
                "dataType": "VARCHAR",
                "sql": "TP_SEXO"
            },
            {
                "name": "DE_FAIXA_ETARIA",
                "label": "Faixa Etária",
                "dataType": "VARCHAR",
                "sql": "DE_FAIXA_ETARIA"
            },
            {
                "name": "DE_FAIXA_ETARIA_REAJ",
                "label": "Faixa Etária Reajuste",
                "dataType": "VARCHAR",
                "sql": "DE_FAIXA_ETARIA_REAJ"
            },
            {
                "name": "TP_VIGENCIA_PLANO",
                "label": "Tipo Vigência Plano",
                "dataType": "VARCHAR",
                "sql": "TP_VIGENCIA_PLANO"
            },
            {
                "name": "DE_CONTRATACAO_PLANO",
                "label": "Tipo Contratação",
                "dataType": "VARCHAR",
                "sql": "DE_CONTRATACAO_PLANO"
            },
            {
                "name": "DE_SEGMENTACAO_PLANO",
                "label": "Segmentação Assistencial",
                "dataType": "VARCHAR",
                "sql": "DE_SEGMENTACAO_PLANO"
            },
            {
                "name": "DE_ABRG_GEOGRAFICA_PLANO",
                "label": "Abrangência Geográfica",
                "dataType": "VARCHAR",
                "sql": "DE_ABRG_GEOGRAFICA_PLANO"
            },
            {
                "name": "COBERTURA_ASSIST_PLAN",
                "label": "Cobertura Assistência",
                "dataType": "VARCHAR",
                "sql": "COBERTURA_ASSIST_PLAN"
            },
            {
                "name": "TIPO_VINCULO",
                "label": "Tipo Vínculo",
                "dataType": "VARCHAR",
                "sql": "TIPO_VINCULO"
            }
        ],
        "measures": [
            {
                "name": "qt_ativos",
                "sql": "SUM(QT_ATIVOS)",
                "label": "Qt Ativos",
                "non_additive_dimension": {
                    "dimension_name": "COMPETENCIA",
                    "window_choice": "MAX"
                }
            },
            {
                "name": "qt_adesoes",
                "sql": "SUM(QT_ADESOES)",
                "label": "Qt Adesões"
            },
            {
                "name": "qt_cancelamentos",
                "sql": "SUM(QT_CANCELAMENTOS)",
                "label": "Qt Cancelamentos"
            },
            {
                "name": "qt_linhas",
                "sql": "COUNT(*)",
                "label": "Qt Linhas"
            }
        ]
    }
}